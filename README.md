# REST API для управления счетами

Приложение предоставляет API для управления балансом счетов, обработки операций пополнения/снятия средств и 
получения текущего баланса.

## Функциональные возможности

1. **Реализованные эндпоинты:**
    - **POST `/api/v1/wallet`**: Выполнение операций пополнения (`DEPOSIT`) или снятия (`WITHDRAW`) средств 
   с указанием суммы и идентификатора кошелька.
   
   Структура тела запроса:
   ```
   {
    walletId: UUID,
    operationType: DEPOSIT or WITHDRAW,
    amount: 1000
    }
    ```
    - **GET `/api/v1/wallets/{walletId}`**: Получение текущего баланса кошелька по его идентификатору.

2. **Особенности:**
    - Конкурентная обработка запросов с поддержкой 1000 RPS на один счёт.
    - Корректная обработка ошибок (некорректный запрос, отсутствие кошелька, недостаточно средств и т.д.).
    - Настройка параметров базы данных через переменные окружения.

## Технологии и инструменты

- **Java**: 17
- **Spring Boot**: 3
- **PostgreSQL**
- **Liquibase**
- **Docker и Docker Compose**
- **JUnit 5**
- **Testcontainers**
- **SpringDoc OpenAPI**
- **MapStruct**
- **Maven**

## Установка и запуск

### 1. Предварительные требования
- Docker и Docker Compose
- Java 17 и PostgreSQL (для локального запуска).

### 2. Запуск приложения
1. Клонирование репозитория:
   ```
   git clone https://github.com/Kick704/wallet.git
   cd <название директории>
   ```
2. Настройка переменных окружения:
   Создать в корне проекта файл `.env` с конфигурацией подключения к базе данных.
   Структура содержимого файла `.env`:
   ```
   DB_URL=jdbc:postgresql://localhost:5432/wallet_db
   DB_USERNAME=username
   DB_PASSWORD=password
   ```
3. Тесты и запуск:
   Тесты запускаются локально:
   ```
   mvn test
   ```
   
   Сборка и запуск контейнеров
   ```
    docker-compose up --build
   ```
 
   API будет доступно по адресу http://localhost:8080
4. Остановка приложения 
   Остановка контейнеров:
   ```
   docker-compose stop
   ```
   Остановка контейнеров с удалением контейнеров и БД
   ```
   docker-compose down -v
   ```

## Примечание
В связи со спецификой ТЗ в приложении нет эндпоинта, который создаёт новый счёт. Поэтому при запуске выполняется 
скрипт заполнения БД счетами:
```
src/main/resources/db/changelog/v0.0.1/insert-data/initial-wallets.xml
```
